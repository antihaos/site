<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Распределенные вычисления - Конспект лекции</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-card: #16213e;
            --accent-primary: #00d4ff;
            --accent-secondary: #ff2e63;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --border-color: #2d3748;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        }

        .lecture-title {
            font-size: 2.5em;
            color: var(--accent-primary);
            text-align: center;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }

        .lecture-subtitle {
            font-size: 1.2em;
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 30px;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        .section {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--border-color);
            position: relative;
            scroll-margin-top: 20px;
        }

        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
        }

        .section-title {
            font-size: 1.8em;
            color: var(--accent-primary);
            margin-bottom: 20px;
            border-bottom: 3px solid var(--accent-primary);
            padding-bottom: 10px;
            font-weight: 600;
        }

        .subsection {
            margin-bottom: 25px;
        }

        .subsection-title {
            font-size: 1.3em;
            color: var(--text-primary);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .text-content {
            margin-bottom: 20px;
            text-align: justify;
            color: var(--text-secondary);
        }

        .diagram {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--border-color);
            overflow-x: auto;
        }

        .formula {
            background: #1e293b;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--accent-secondary);
            font-family: 'Cambria Math', serif;
        }

        .formula-title {
            font-size: 1.1em;
            color: var(--accent-primary);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .formula-explanation {
            margin-top: 10px;
            font-size: 0.9em;
            color: var(--text-secondary);
            text-align: left;
        }

        .katex-formula {
            font-size: 1.1em;
            overflow-x: auto;
            color: var(--text-primary);
            text-align: center;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--bg-secondary);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .comparison-table th {
            background: var(--accent-primary);
            color: var(--bg-primary);
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .comparison-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.05);
        }

        .comparison-table tr:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .highlight {
            background: linear-gradient(120deg, rgba(0, 212, 255, 0.2) 0%, rgba(255, 46, 99, 0.2) 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
            color: var(--accent-primary);
        }

        .navigation {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: rgba(26, 26, 46, 0.9);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            z-index: 100;
            max-height: 80vh;
            overflow-y: auto;
        }

        .nav-item {
            display: block;
            padding: 10px 15px;
            margin: 5px 0;
            background: var(--accent-primary);
            color: var(--bg-primary);
            text-decoration: none;
            border-radius: 5px;
            text-align: center;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover {
            background: var(--accent-secondary);
            transform: translateX(-5px);
        }

        ul, ol {
            margin-left: 20px;
            margin-bottom: 15px;
            color: var(--text-secondary);
        }

        li {
            margin-bottom: 8px;
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transform-origin: left;
            transform: scaleX(0);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .architecture-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .architecture-card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid var(--accent-primary);
            transition: transform 0.3s ease;
        }

        .architecture-card:hover {
            transform: translateY(-5px);
        }

        .architecture-title {
            font-size: 1.2em;
            color: var(--accent-primary);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .tech-card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid var(--accent-secondary);
            transition: transform 0.3s ease;
        }

        .tech-card:hover {
            transform: translateY(-5px);
        }

        .tech-name {
            font-size: 1.2em;
            color: var(--accent-secondary);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .mobile-menu-toggle {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--accent-primary);
            color: var(--bg-primary);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5em;
            cursor: pointer;
            z-index: 101;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .mobile-menu-toggle:hover {
            background: var(--accent-secondary);
            transform: scale(1.1);
        }

        .quiz-section {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-secondary);
        }

        .quiz-question {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .quiz-options {
            margin-bottom: 15px;
        }

        .quiz-option {
            display: block;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .quiz-option:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .quiz-option.correct {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
        }

        .quiz-option.incorrect {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.5);
        }

        .quiz-feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }

        .quiz-feedback.correct {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
            display: block;
        }

        .quiz-feedback.incorrect {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.5);
            display: block;
        }

        .key-points {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(255, 46, 99, 0.1) 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-primary);
        }

        .key-points-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--accent-primary);
        }

        .use-case-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .use-case-card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid var(--accent-primary);
        }

        .use-case-title {
            font-weight: 600;
            color: var(--accent-primary);
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .navigation {
                display: none;
                width: 80%;
                right: 10%;
                top: 50%;
                transform: translateY(-50%);
            }

            .navigation.active {
                display: block;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .lecture-title {
                font-size: 2em;
            }

            .section {
                padding: 20px;
            }

            .section-title {
                font-size: 1.5em;
            }

            .header {
                padding: 25px;
            }

            .architecture-grid {
                grid-template-columns: 1fr;
            }

            .tech-grid {
                grid-template-columns: 1fr;
            }

            .use-case-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .lecture-title {
                font-size: 1.7em;
            }

            .section {
                padding: 15px;
            }

            .header {
                padding: 20px;
            }

            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="progress-bar" id="progressBar"></div>

    <button class="mobile-menu-toggle" id="mobileMenuToggle">☰</button>

    <div class="navigation" id="navigation">
        <a href="#section1" class="nav-item">Введение</a>
        <a href="#section2" class="nav-item">Архитектура</a>
        <a href="#section3" class="nav-item">HDFS</a>
        <a href="#section4" class="nav-item">MapReduce</a>
        <a href="#section5" class="nav-item">YARN</a>
        <a href="#section6" class="nav-item">Экосистема</a>
        <a href="#section7" class="nav-item">Apache Spark</a>
        <a href="#section8" class="nav-item">Apache Flink</a>
        <a href="#section9" class="nav-item">Сравнение</a>
        <a href="#quiz" class="nav-item">Тест (25 вопросов)</a>
    </div>

    <div class="container">
        <div class="header">
            <h1 class="lecture-title">Распределенные вычисления в облачных средах</h1>
            <p class="lecture-subtitle">Технологии Apache Hadoop, Spark, Flink и экосистема больших данных</p>
        </div>

        <div class="content">
            <!-- Раздел 1: Введение -->
            <div class="section" id="section1">
                <h2 class="section-title">1. Введение в распределенные вычисления</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Проблема больших данных</h3>
                    <div class="text-content">
                        <p>Современные организации генерируют огромные объемы данных, которые невозможно обработать на одном компьютере. Распределенные вычисления решают эту проблему, разделяя задачу между множеством узлов.</p>
                    </div>

                    <div class="diagram">
                        <div class="mermaid">
                            graph LR
                                A[Большие данные<br>Терабайты/петабайты] --> B[Проблемы<br>одного сервера]
                                B --> C["Ограничения:<br>- Производительность CPU<br>- Объем памяти<br>- Пропускная способность I/O<br>- Надежность"]
                                C --> D[Решение:<br>распределенные<br>вычисления]
                                D --> E["Преимущества:<br>- Масштабируемость<br>- Отказоустойчивость<br>- Экономическая эффективность"]
                        </div>
                    </div>

                    <div class="text-content">
                        <p><strong>Характеристики больших данных (5V):</strong></p>
                        <ul>
                            <li><span class="highlight">Volume</span>: объем данных (терабайты, петабайты)</li>
                            <li><span class="highlight">Velocity</span>: скорость генерации и обработки</li>
                            <li><span class="highlight">Variety</span>: разнообразие форматов и структур</li>
                            <li><span class="highlight">Veracity</span>: достоверность и качество данных</li>
                            <li><span class="highlight">Value</span>: ценность извлекаемой информации</li>
                        </ul>

                        <div class="formula">
                            <div class="formula-title">Закон Амдала</div>
                            <div class="katex-formula" id="formula1"></div>
                            <div class="formula-explanation">
                                <p>где:</p>
                                <ul>
                                    <li>\( S \) - ускорение выполнения программы</li>
                                    <li>\( p \) - доля параллелизуемой части программы</li>
                                    <li>\( N \) - количество процессоров</li>
                                </ul>
                                <p>Закон Амдала показывает теоретический предел ускорения при параллелизации вычислений.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">История Apache Hadoop</h3>
                    <div class="diagram">
                        <div class="mermaid">
                            timeline
                                title История развития Hadoop
                                section 2003-2004
                                    Google File System : Статья о GFS
                                    MapReduce : Публикация Google
                                section 2005-2006
                                    Nutch : Разработка DFS<br>и MapReduce
                                    Yahoo! : Принятие Hadoop
                                section 2007-2008
                                    Apache Top-Level : Проект становится<br>Apache TLP
                                    Hive & Pig : Появление инструментов<br>высокого уровня
                                section 2009-2010
                                    HBase : Колоночная БД
                                    YARN : Разделение ресурсов<br>и планирования
                                section 2011-2014
                                    Spark : Альтернатива MapReduce
                                    Hadoop 2.0 : YARN и улучшения
                        </div>
                    </div>

                    <div class="text-content">
                        <p>Hadoop был создан Doug Cutting и Mike Cafarella в 2005 году как часть проекта Nutch. Название происходит от имени плюшевого слона сына Дага Каттинга. Основные вдохновляющие технологии:</p>
                        <ul>
                            <li><span class="highlight">Google File System (GFS)</span>: распределенная файловая система</li>
                            <li><span class="highlight">MapReduce</span>: модель программирования для обработки данных</li>
                            <li><span class="highlight">Bigtable</span>: распределенная база данных</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Раздел 2: Архитектура -->
            <div class="section" id="section2">
                <h2 class="section-title">2. Архитектура распределенных систем</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Основные компоненты Hadoop</h3>
                    <div class="diagram">
                        <div class="mermaid">
                            flowchart TD
                                A[Hadoop Architecture] --> B[HDFS<br>Hadoop Distributed File System]
                                A --> C[MapReduce<br>Processing Framework]
                                A --> D[YARN<br>Resource Management]
                                A --> E[Common<br>Utilities & Libraries]

                                B --> F[NameNode<br>Master]
                                B --> G[DataNode<br>Slave]
                                B --> H[Secondary NameNode<br>Checkpoint]

                                D --> K[ResourceManager<br>Master]
                                D --> L[NodeManager<br>Slave]
                                D --> M[ApplicationMaster<br>Per Application]
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Принципы проектирования</h3>

                    <div class="architecture-grid">
                        <div class="architecture-card">
                            <div class="architecture-title">Масштабируемость</div>
                            <div class="text-content">
                                <p>Система должна легко масштабироваться добавлением новых узлов без изменения архитектуры.</p>
                                <ul>
                                    <li>Горизонтальное масштабирование</li>
                                    <li>Линейное увеличение производительности</li>
                                    <li>Минимальные overhead при добавлении узлов</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">Отказоустойчивость</div>
                            <div class="text-content">
                                <p>Система продолжает работать при отказах отдельных компонентов.</p>
                                <ul>
                                    <li>Репликация данных</li>
                                    <li>Автоматическое восстановление</li>
                                    <li>Избыточность компонентов</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">Локализация данных</div>
                            <div class="text-content">
                                <p>Вычисления выполняются там, где находятся данные.</p>
                                <ul>
                                    <li>Минимизация передачи данных</li>
                                    <li>Использование локальных дисков</li>
                                    <li>Оптимизация сетевого трафика</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="formula">
                        <div class="formula-title">CAP-теорема</div>
                        <div class="katex-formula" id="formula2"></div>
                        <div class="formula-explanation">
                            <p>В распределенной системе можно гарантировать только два из трех свойств:</p>
                            <ul>
                                <li><strong>Consistency</strong>: все узлы видят одинаковые данные</li>
                                <li><strong>Availability</strong>: система всегда отвечает на запросы</li>
                                <li><strong>Partition tolerance</strong>: система работает при сетевых разделах</li>
                            </ul>
                            <p>Hadoop выбирает AP (Availability + Partition tolerance).</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Раздел 3: HDFS -->
            <div class="section" id="section3">
                <h2 class="section-title">3. HDFS (Hadoop Distributed File System)</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Архитектура HDFS</h3>
                    <div class="diagram">
                        <div class="mermaid">
                            flowchart TD
                                A[Client] --> B[NameNode<br>Metadata Operations]
                                A --> C[DataNode 1<br>Block A: 1,2]
                                A --> D[DataNode 2<br>Block A: 1,3]
                                A --> E[DataNode 3<br>Block A: 2,3]

                                B --> F[Metadata:<br>Files, Blocks, Locations]
                                B --> G[EditLog<br>Transaction Log]
                                B --> H[FsImage<br>Checkpoint]

                                C --> I[Block 1A<br>128MB]
                                C --> J[Block 2A<br>128MB]
                                D --> K[Block 1A Replica]
                                D --> L[Block 3A<br>64MB]
                                E --> M[Block 2A Replica]
                                E --> N[Block 3A Replica]

                                style B fill:#ff6b6b
                                style C fill:#4ecdc4
                                style D fill:#4ecdc4
                                style E fill:#4ecdc4
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Ключевые особенности HDFS</h3>

                    <div class="formula">
                        <div class="formula-title">Размер блока HDFS</div>
                        <div class="katex-formula" id="formula3"></div>
                        <div class="formula-explanation">
                            <p>Большие блоки уменьшают метаданные и улучшают производительность последовательного чтения. По умолчанию размер блока - 128 МБ (в Hadoop 1.x - 64 МБ).</p>
                        </div>
                    </div>

                    <div class="formula">
                        <div class="formula-title">Фактор репликации</div>
                        <div class="katex-formula" id="formula4"></div>
                        <div class="formula-explanation">
                            <p>Каждый блок реплицируется на несколько DataNodes (по умолчанию - 3 копии). Это обеспечивает отказоустойчивость и доступность данных.</p>
                        </div>
                    </div>

                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Компонент</th>
                                <th>Роль</th>
                                <th>Характеристики</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>NameNode</td>
                                <td>Мастер-узел</td>
                                <td>Хранит метаданные, управляет пространством имен</td>
                            </tr>
                            <tr>
                                <td>DataNode</td>
                                <td>Воркер-узел</td>
                                <td>Хранит данные, обслуживает запросы чтения/записи</td>
                            </tr>
                            <tr>
                                <td>Secondary NameNode</td>
                                <td>Вспомогательный</td>
                                <td>Выполняет checkpoint'ы, не является резервной копией</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Раздел 4: MapReduce -->
            <div class="section" id="section4">
                <h2 class="section-title">4. Модель программирования MapReduce</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Архитектура MapReduce</h3>
                    <div class="diagram">
                        <div class="mermaid">
                            flowchart TD
                                A[Input Data<br>HDFS] --> B[Split 1]
                                A --> C[Split 2]
                                A --> D[Split N]

                                B --> E[Map Task 1]
                                C --> F[Map Task 2]
                                D --> G[Map Task N]

                                E --> H[("Partition & Sort")]
                                F --> H
                                G --> H

                                H --> I[Reduce Task 1]
                                H --> J[Reduce Task 2]
                                H --> K[Reduce Task M]

                                I --> L[Output 1<br>HDFS]
                                J --> M[Output 2<br>HDFS]
                                K --> N[Output M<br>HDFS]

                                style E fill:#4ecdc4
                                style F fill:#4ecdc4
                                style G fill:#4ecdc4
                                style I fill:#ff6b6b
                                style J fill:#ff6b6b
                                style K fill:#ff6b6b
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Фазы MapReduce</h3>

                    <div class="formula">
                        <div class="formula-title">Общая модель MapReduce</div>
                        <div class="katex-formula" id="formula5"></div>
                        <div class="formula-explanation">
                            <p>где:</p>
                            <ul>
                                <li>\( map(k1, v1) \rightarrow list(k2, v2) \) - функция преобразования входных данных</li>
                                <li>\( reduce(k2, list(v2)) \rightarrow list(v3) \) - функция агрегации данных</li>
                            </ul>
                        </div>
                    </div>

                    <div class="text-content">
                        <p><strong>Фазы выполнения:</strong></p>
                        <ol>
                            <li><span class="highlight">Split</span>: входные данные разбиваются на части</li>
                            <li><span class="highlight">Map</span>: параллельная обработка каждой части</li>
                            <li><span class="highlight">Shuffle</span>: передача данных между узлами</li>
                            <li><span class="highlight">Sort</span>: сортировка данных по ключам</li>
                            <li><span class="highlight">Reduce</span>: агрегация и финальная обработка</li>
                            <li><span class="highlight">Output</span>: сохранение результатов в HDFS</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- Раздел 5: YARN -->
            <div class="section" id="section5">
                <h2 class="section-title">5. YARN (Yet Another Resource Negotiator)</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Архитектура YARN</h3>
                    <div class="diagram">
                        <div class="mermaid">
                            flowchart TD
                                A[Client] --> B[ResourceManager<br>Global Resource Manager]

                                B --> C[NodeManager 1<br>Per-Node Agent]
                                B --> D[NodeManager 2<br>Per-Node Agent]
                                B --> E[NodeManager N<br>Per-Node Agent]

                                C --> F[Container 1.1<br>App Master]
                                C --> G[Container 1.2<br>Task]
                                C --> H[Container 1.N<br>Task]

                                D --> I[Container 2.1<br>Task]
                                D --> J[Container 2.2<br>Task]

                                E --> K[Container N.1<br>Task]

                                F --> L[Application Master<br>Per Application]
                                L --> M[Negotiates Resources]
                                L --> N[Monitors Tasks]

                                style B fill:#ff6b6b
                                style C fill:#4ecdc4
                                style D fill:#4ecdc4
                                style E fill:#4ecdc4
                                style F fill:#ffe66d
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Компоненты YARN</h3>

                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Компонент</th>
                                <th>Роль</th>
                                <th>Описание</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ResourceManager</td>
                                <td>Глобальный менеджер</td>
                                <td>Управляет ресурсами кластера, планирует задания</td>
                            </tr>
                            <tr>
                                <td>NodeManager</td>
                                <td>Агент на узле</td>
                                <td>Управляет ресурсами узла, запускает контейнеры</td>
                            </tr>
                            <tr>
                                <td>ApplicationMaster</td>
                                <td>Мастер приложения</td>
                                <td>Управляет жизненным циклом одного приложения</td>
                            </tr>
                            <tr>
                                <td>Container</td>
                                <td>Единица ресурсов</td>
                                <td>Изолированная среда с выделенными ресурсами</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="text-content">
                        <p><strong>Преимущества YARN перед MapReduce v1:</strong></p>
                        <ul>
                            <li><span class="highlight">Масштабируемость</span>: поддержка кластеров до 10,000 узлов</li>
                            <li><span class="highlight">Гибкость</span>: поддержка различных вычислительных моделей</li>
                            <li><span class="highlight">Эффективность</span>: лучшее использование ресурсов</li>
                            <li><span class="highlight">Мультитенантность</span>: одновременное выполнение разных приложений</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Раздел 6: Экосистема Hadoop -->
            <div class="section" id="section6">
                <h2 class="section-title">6. Экосистема Hadoop</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Основные компоненты экосистемы</h3>

                    <div class="tech-grid">
                        <div class="tech-card">
                            <div class="tech-name">Apache Hive</div>
                            <div class="text-content">
                                <p>Data warehouse система с SQL-подобным языком запросов (HiveQL).</p>
                                <p><strong>Применение:</strong> Аналитические запросы, ETL процессы</p>
                                <p><strong>Особенности:</strong> Преобразует SQL в MapReduce/Tez/Spark задания</p>
                            </div>
                        </div>

                        <div class="tech-card">
                            <div class="tech-name">Apache Pig</div>
                            <div class="text-content">
                                <p>Платформа для анализа больших данных с языком Pig Latin.</p>
                                <p><strong>Применение:</strong> ETL, анализ данных</p>
                                <p><strong>Особенности:</strong> Процедурный язык, оптимизация выполнения</p>
                            </div>
                        </div>

                        <div class="tech-card">
                            <div class="tech-name">Apache HBase</div>
                            <div class="text-content">
                                <p>Распределенная колоночная база данных.</p>
                                <p><strong>Применение:</strong> Оперативные запросы, случайный доступ</p>
                                <p><strong>Особенности:</strong> Модель Bigtable, сильная согласованность</p>
                            </div>
                        </div>

                        <div class="tech-card">
                            <div class="tech-name">Apache ZooKeeper</div>
                            <div class="text-content">
                                <p>Сервис координации распределенных систем.</p>
                                <p><strong>Применение:</strong> Конфигурация, синхронизация, именование</p>
                                <p><strong>Особенности:</strong> Распределенный консенсус, высокая доступность</p>
                            </div>
                        </div>

                        <div class="tech-card">
                            <div class="tech-name">Apache Sqoop</div>
                            <div class="text-content">
                                <p>Инструмент для передачи данных между Hadoop и реляционными БД.</p>
                                <p><strong>Применение:</strong> Импорт/экспорт данных</p>
                                <p><strong>Особенности:</strong> Поддержка различных СУБД, параллельная передача</p>
                            </div>
                        </div>

                        <div class="tech-card">
                            <div class="tech-name">Apache Flume</div>
                            <div class="text-content">
                                <p>Сервис для сбора, агрегации и перемещения логов.</p>
                                <p><strong>Применение:</strong> Сбор логов, потоковая передача данных</p>
                                <p><strong>Особенности:</strong> Надежная доставка, отказоустойчивость</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Раздел 7: Apache Spark -->
            <div class="section" id="section7">
                <h2 class="section-title">7. Apache Spark - современная альтернатива</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Архитектура Spark</h3>
                    <div class="diagram">
                        <div class="mermaid">
                            flowchart TD
                                A[Spark Application] --> B[SparkContext<br>Driver Program]

                                B --> C[Cluster Manager<br>Standalone/YARN/Mesos]
                                C --> D[Worker Node 1]
                                C --> E[Worker Node 2]
                                C --> F[Worker Node N]

                                D --> G[Executor<br>JVM Process]
                                E --> H[Executor<br>JVM Process]
                                F --> I[Executor<br>JVM Process]

                                G --> J[Cache<br>In-Memory Storage]
                                G --> K[Task Threads]

                                H --> L[Cache<br>In-Memory Storage]
                                H --> M[Task Threads]

                                I --> N[Cache<br>In-Memory Storage]
                                I --> O[Task Threads]

                                style B fill:#ff6b6b
                                style D fill:#4ecdc4
                                style E fill:#4ecdc4
                                style F fill:#4ecdc4
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Преимущества Spark</h3>

                    <div class="formula">
                        <div class="formula-title">Скорость выполнения</div>
                        <div class="katex-formula" id="formula6"></div>
                        <div class="formula-explanation">
                            <p>Spark работает в 10-100 раз быстрее Hadoop MapReduce благодаря использованию памяти и оптимизированному выполнению.</p>
                        </div>
                    </div>

                    <div class="text-content">
                        <p><strong>Ключевые особенности Spark:</strong></p>
                        <ul>
                            <li><span class="highlight">In-Memory Computing</span>: данные хранятся в памяти</li>
                            <li><span class="highlight">Lazy Evaluation</span>: оптимизация плана выполнения</li>
                            <li><span class="highlight">Resilient Distributed Datasets (RDD)</span>: основная абстракция данных</li>
                            <li><span class="highlight">Unified Stack</span>: поддержка различных workload'ов</li>
                        </ul>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Компоненты Spark Stack</h3>

                    <div class="architecture-grid">
                        <div class="architecture-card">
                            <div class="architecture-title">Spark SQL</div>
                            <div class="text-content">
                                <p>Модуль для работы со структурированными данными через SQL и DataFrame API.</p>
                                <ul>
                                    <li>Поддержка Hive</li>
                                    <li>Catalyst optimizer</li>
                                    <li>Tungsten execution engine</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">Spark Streaming</div>
                            <div class="text-content">
                                <p>Обработка потоковых данных в реальном времени.</p>
                                <ul>
                                    <li>Micro-batch processing</li>
                                    <li>Exactly-once semantics</li>
                                    <li>Интеграция с Kafka, Flume</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">MLlib</div>
                            <div class="text-content">
                                <p>Библиотека машинного обучения.</p>
                                <ul>
                                    <li>Распределенные алгоритмы</li>
                                    <li>Feature extraction</li>
                                    <li>Model evaluation</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">GraphX</div>
                            <div class="text-content">
                                <p>Библиотека для работы с графами.</p>
                                <ul>
                                    <li>Graph algorithms</li>
                                    <li>Pregel API</li>
                                    <li>Оптимизация графов</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">RDD (Resilient Distributed Datasets)</h3>
                    <div class="text-content">
                        <p>RDD - основная абстракция данных в Spark, представляющая собой неизменяемую распределенную коллекцию объектов.</p>

                        <p><strong>Свойства RDD:</strong></p>
                        <ul>
                            <li><span class="highlight">Resilient</span>: устойчивость к сбоям через lineage</li>
                            <li><span class="highlight">Distributed</span>: данные распределены по кластеру</li>
                            <li><span class="highlight">Immutable</span>: неизменяемость обеспечивает безопасность</li>
                        </ul>

                        <p><strong>Трансформации и действия:</strong></p>
                        <ul>
                            <li><span class="highlight">Трансформации</span>: создают новые RDD (map, filter, reduceByKey)</li>
                            <li><span class="highlight">Действия</span>: возвращают результаты (count, collect, save)</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Раздел 8: Apache Flink -->
            <div class="section" id="section8">
                <h2 class="section-title">8. Apache Flink - потоковая обработка</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Архитектура Flink</h3>
                    <div class="diagram">
                        <div class="mermaid">
                            flowchart TD
                                A[Flink Application] --> B[JobManager<br>Master Node]

                                B --> C[TaskManager 1<br>Worker Node]
                                B --> D[TaskManager 2<br>Worker Node]
                                B --> E[TaskManager N<br>Worker Node]

                                C --> F[Task Slots<br>Execution Units]
                                D --> G[Task Slots<br>Execution Units]
                                E --> H[Task Slots<br>Execution Units]

                                F --> I[Stream Tasks<br>Parallel Instances]
                                G --> J[Stream Tasks<br>Parallel Instances]
                                H --> K[Stream Tasks<br>Parallel Instances]

                                L[Data Sources<br>Kafka, Files, Sockets] --> M[Flink Program<br>DataStream API]
                                M --> N[Data Sinks<br>Kafka, Files, Databases]

                                style B fill:#ff6b6b
                                style C fill:#4ecdc4
                                style D fill:#4ecdc4
                                style E fill:#4ecdc4
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Ключевые особенности Flink</h3>

                    <div class="text-content">
                        <p><strong>Отличия от Spark Streaming:</strong></p>
                        <ul>
                            <li><span class="highlight">Нативная потоковая обработка</span>: не использует micro-batches</li>
                            <li><span class="highlight">Exactly-once гарантии</span>: для состояния и обработки</li>
                            <li><span class="highlight">Low latency</span>: миллисекундные задержки</li>
                            <li><span class="highlight">Event time processing</span>: обработка по времени событий</li>
                        </ul>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Обработка времени в Flink</h3>
                    <div class="text-content">
                        <p>Flink поддерживает три типа времени событий:</p>
                        <ul>
                            <li><span class="highlight">Event Time</span>: время создания события</li>
                            <li><span class="highlight">Processing Time</span>: время обработки события системой</li>
                            <li><span class="highlight">Ingestion Time</span>: время поступления события в Flink</li>
                        </ul>

                        <p><strong>Watermarks:</strong> механизм для обработки задержек в потоковых данных.</p>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Состояния и контрольные точки</h3>
                    <div class="text-content">
                        <p>Flink предоставляет надежные механизмы управления состоянием:</p>
                        <ul>
                            <li><span class="highlight">Keyed State</span>: состояние, привязанное к ключу</li>
                            <li><span class="highlight">Operator State</span>: состояние оператора</li>
                            <li><span class="highlight">Checkpointing</span>: создание снимков состояния</li>
                            <li><span class="highlight">Savepoints</span>: контрольные точки, управляемые пользователем</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Раздел 9: Сравнение технологий -->
            <div class="section" id="section9">
                <h2 class="section-title">9. Сравнение технологий распределенных вычислений</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Сравнительная таблица</h3>

                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Параметр</th>
                                <th>Hadoop MapReduce</th>
                                <th>Apache Spark</th>
                                <th>Apache Flink</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Модель выполнения</td>
                                <td>Batch</td>
                                <td>Batch + Micro-batch</td>
                                <td>Streaming-first</td>
                            </tr>
                            <tr>
                                <td>Задержка</td>
                                <td>Минуты-часы</td>
                                <td>Секунды-минуты</td>
                                <td>Миллисекунды</td>
                            </tr>
                            <tr>
                                <td>Использование памяти</td>
                                <td>Диск</td>
                                <td>Память+Диск</td>
                                <td>Память+Диск</td>
                            </tr>
                            <tr>
                                <td>Гарантии доставки</td>
                                <td>At-least-once</td>
                                <td>Exactly-once</td>
                                <td>Exactly-once</td>
                            </tr>
                            <tr>
                                <td>API</td>
                                <td>MapReduce</td>
                                <td>RDD, DataFrame, SQL</td>
                                <td>DataStream, DataSet, SQL</td>
                            </tr>
                            <tr>
                                <td>Использование</td>
                                <td>ETL, Аналитика</td>
                                <td>ML, Аналитика, Streaming</td>
                                <td>Real-time, CEP, Analytics</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Критерии выбора технологии</h3>

                    <div class="use-case-grid">
                        <div class="use-case-card">
                            <div class="use-case-title">Hadoop MapReduce</div>
                            <div class="text-content">
                                <p><strong>Когда использовать:</strong></p>
                                <ul>
                                    <li>Очень большие batch-процессы</li>
                                    <li>Ограниченный бюджет</li>
                                    <li>Стабильность важнее производительности</li>
                                </ul>
                            </div>
                        </div>

                        <div class="use-case-card">
                            <div class="use-case-title">Apache Spark</div>
                            <div class="text-content">
                                <p><strong>Когда использовать:</strong></p>
                                <ul>
                                    <li>Интерактивная аналитика</li>
                                    <li>Машинное обучение</li>
                                    <li>Near-real-time обработка</li>
                                </ul>
                            </div>
                        </div>

                        <div class="use-case-card">
                            <div class="use-case-title">Apache Flink</div>
                            <div class="text-content">
                                <p><strong>Когда использовать:</strong></p>
                                <ul>
                                    <li>Real-time обработка</li>
                                    <li>Сложная event-driven логика</li>
                                    <li>Требования к низкой задержке</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Раздел: Тест -->
            <div class="section" id="quiz">
                <h2 class="section-title">Тест: Проверка знаний (25 вопросов)</h2>

                <div class="quiz-section">
                    <div class="quiz-question">1. Какой компонент HDFS отвечает за хранение метаданных?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">NameNode</div>
                        <div class="quiz-option" data-correct="false">DataNode</div>
                        <div class="quiz-option" data-correct="false">Secondary NameNode</div>
                        <div class="quiz-option" data-correct="false">JobTracker</div>
                    </div>
                    <div class="quiz-feedback">NameNode хранит все метаданные файловой системы, включая информацию о файлах, блоках и их расположении.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">2. Какое основное преимущество Spark перед Hadoop MapReduce?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Более простая установка</div>
                        <div class="quiz-option" data-correct="true">Использование памяти для промежуточных данных</div>
                        <div class="quiz-option" data-correct="false">Поддержка только Java</div>
                        <div class="quiz-option" data-correct="false">Отсутствие зависимостей</div>
                    </div>
                    <div class="quiz-feedback">Spark использует память для хранения промежуточных данных, что значительно ускоряет выполнение итеративных алгоритмов и интерактивных запросов.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">3. Какой компонент YARN отвечает за управление ресурсами всего кластера?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">ResourceManager</div>
                        <div class="quiz-option" data-correct="false">NodeManager</div>
                        <div class="quiz-option" data-correct="false">ApplicationMaster</div>
                        <div class="quiz-option" data-correct="false">Container</div>
                    </div>
                    <div class="quiz-feedback">ResourceManager - это главный компонент YARN, который управляет ресурсами всего кластера и планирует выполнение приложений.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">4. Какая технология лучше всего подходит для real-time обработки потоковых данных с минимальной задержкой?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Hadoop MapReduce</div>
                        <div class="quiz-option" data-correct="false">Apache Spark</div>
                        <div class="quiz-option" data-correct="true">Apache Flink</div>
                        <div class="quiz-option" data-correct="false">Apache Hive</div>
                    </div>
                    <div class="quiz-feedback">Apache Flink предоставляет нативную потоковую обработку с минимальной задержкой и exactly-once семантикой, что делает его идеальным для real-time приложений.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">5. Какой фактор репликации используется в HDFS по умолчанию?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">1</div>
                        <div class="quiz-option" data-correct="false">2</div>
                        <div class="quiz-option" data-correct="true">3</div>
                        <div class="quiz-option" data-correct="false">4</div>
                    </div>
                    <div class="quiz-feedback">По умолчанию HDFS хранит 3 копии каждого блока данных для обеспечения отказоустойчивости.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">6. Что означает аббревиатура RDD в Apache Spark?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">Resilient Distributed Dataset</div>
                        <div class="quiz-option" data-correct="false">Real-time Data Distribution</div>
                        <div class="quiz-option" data-correct="false">Reliable Data Division</div>
                        <div class="quiz-option" data-correct="false">Rapid Data Deployment</div>
                    </div>
                    <div class="quiz-feedback">RDD (Resilient Distributed Dataset) - это основная абстракция данных в Spark, представляющая собой неизменяемую распределенную коллекцию объектов.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">7. Какой компонент Hadoop экосистемы используется для SQL-подобных запросов?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Pig</div>
                        <div class="quiz-option" data-correct="true">Hive</div>
                        <div class="quiz-option" data-correct="false">HBase</div>
                        <div class="quiz-option" data-correct="false">ZooKeeper</div>
                    </div>
                    <div class="quiz-feedback">Apache Hive предоставляет SQL-подобный язык запросов (HiveQL) для работы с большими данными в Hadoop.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">8. Какой механизм использует Spark для обеспечения отказоустойчивости RDD?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">Lineage (цепочка преобразований)</div>
                        <div class="quiz-option" data-correct="false">Репликация данных</div>
                        <div class="quiz-option" data-correct="false">Контрольные точки</div>
                        <div class="quiz-option" data-correct="false">Транзакционные журналы</div>
                    </div>
                    <div class="quiz-feedback">Spark использует lineage (цепочку преобразований) для восстановления потерянных данных путем повторного выполнения операций.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">9. Какой размер блока используется в HDFS по умолчанию в современных версиях Hadoop?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">64 МБ</div>
                        <div class="quiz-option" data-correct="true">128 МБ</div>
                        <div class="quiz-option" data-correct="false">256 МБ</div>
                        <div class="quiz-option" data-correct="false">512 МБ</div>
                    </div>
                    <div class="quiz-feedback">В Hadoop 2.x и 3.x по умолчанию используется размер блока 128 МБ (в Hadoop 1.x было 64 МБ).</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">10. Какой компонент Flink отвечает за управление состоянием и контрольными точками?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">TaskManager</div>
                        <div class="quiz-option" data-correct="true">JobManager</div>
                        <div class="quiz-option" data-correct="false">ResourceManager</div>
                        <div class="quiz-option" data-correct="false">ApplicationMaster</div>
                    </div>
                    <div class="quiz-feedback">JobManager в Flink координирует распределенное выполнение задач, управляет контрольными точками и восстановлением после сбоев.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">11. Какая модель выполнения используется в Spark Streaming?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Нативная потоковая обработка</div>
                        <div class="quiz-option" data-correct="true">Micro-batch processing</div>
                        <div class="quiz-option" data-correct="false">Event-driven processing</div>
                        <div class="quiz-option" data-correct="false">Request-response processing</div>
                    </div>
                    <div class="quiz-feedback">Spark Streaming использует micro-batch processing, где потоковые данные разбиваются на небольшие пакеты (батчи) для обработки.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">12. Какой инструмент Hadoop экосистемы используется для передачи данных между Hadoop и реляционными БД?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Flume</div>
                        <div class="quiz-option" data-correct="true">Sqoop</div>
                        <div class="quiz-option" data-correct="false">ZooKeeper</div>
                        <div class="quiz-option" data-correct="false">Oozie</div>
                    </div>
                    <div class="quiz-feedback">Apache Sqoop предназначен для передачи данных между Hadoop и структурированными хранилищами данных, такими как реляционные БД.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">13. Что такое "ленивое выполнение" (lazy evaluation) в Spark?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">Отложенное выполнение преобразований до вызова действия</div>
                        <div class="quiz-option" data-correct="false">Медленное выполнение операций</div>
                        <div class="quiz-option" data-correct="false">Выполнение в фоновом режиме</div>
                        <div class="quiz-option" data-correct="false">Асинхронное выполнение задач</div>
                    </div>
                    <div class="quiz-feedback">Ленивое выполнение означает, что преобразования RDD не выполняются немедленно, а откладываются до вызова действия, что позволяет оптимизировать план выполнения.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">14. Какой тип времени обработки в Flink использует временные метки событий?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">Event Time</div>
                        <div class="quiz-option" data-correct="false">Processing Time</div>
                        <div class="quiz-option" data-correct="false">Ingestion Time</div>
                        <div class="quiz-option" data-correct="false">System Time</div>
                    </div>
                    <div class="quiz-feedback">Event Time использует временные метки, встроенные в сами данные событий, что позволяет корректно обрабатывать события с задержками.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">15. Какой компонент Hadoop отвечает за координацию распределенных приложений?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">YARN</div>
                        <div class="quiz-option" data-correct="false">HDFS</div>
                        <div class="quiz-option" data-correct="true">ZooKeeper</div>
                        <div class="quiz-option" data-correct="false">MapReduce</div>
                    </div>
                    <div class="quiz-feedback">Apache ZooKeeper предоставляет сервисы координации для распределенных систем, такие как конфигурация, синхронизация и именование.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">16. Что такое DataSet API в Apache Flink?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">API для работы с потоковыми данными</div>
                        <div class="quiz-option" data-correct="true">API для работы с пакетными данными</div>
                        <div class="quiz-option" data-correct="false">API для машинного обучения</div>
                        <div class="quiz-option" data-correct="false">API для работы с графами</div>
                    </div>
                    <div class="quiz-feedback">DataSet API в Flink предназначен для работы с пакетными (batch) данными, в то время как DataStream API используется для потоковой обработки.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">17. Какой механизм в MapReduce отвечает за передачу данных между Map и Reduce фазами?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Sort</div>
                        <div class="quiz-option" data-correct="true">Shuffle</div>
                        <div class="quiz-option" data-correct="false">Partition</div>
                        <div class="quiz-option" data-correct="false">Combine</div>
                    </div>
                    <div class="quiz-feedback">Shuffle - это процесс передачи данных от задач Map к задачам Reduce, включающий сортировку и распределение данных по ключам.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">18. Какая библиотека Spark используется для машинного обучения?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Spark SQL</div>
                        <div class="quiz-option" data-correct="false">Spark Streaming</div>
                        <div class="quiz-option" data-correct="true">MLlib</div>
                        <div class="quiz-option" data-correct="false">GraphX</div>
                    </div>
                    <div class="quiz-feedback">MLlib - это библиотека машинного обучения Spark, содержащая распространенные алгоритмы и утилиты для работы с ML.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">19. Что такое "watermarks" в Apache Flink?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">Механизм обработки задержек в потоковых данных</div>
                        <div class="quiz-option" data-correct="false">Система управления памятью</div>
                        <div class="quiz-option" data-correct="false">Метод балансировки нагрузки</div>
                        <div class="quiz-option" data-correct="false">Протокол репликации данных</div>
                    </div>
                    <div class="quiz-feedback">Watermarks в Flink - это механизм, который указывает, что все события с временными метками до определенного момента времени уже поступили в систему.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">20. Какой компонент YARN запускается на каждом узле кластера?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">ResourceManager</div>
                        <div class="quiz-option" data-correct="true">NodeManager</div>
                        <div class="quiz-option" data-correct="false">ApplicationMaster</div>
                        <div class="quiz-option" data-correct="false">Container</div>
                    </div>
                    <div class="quiz-feedback">NodeManager запускается на каждом узле кластера и отвечает за управление ресурсами этого узла и выполнение задач.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">21. Какая основная абстракция данных в Spark SQL?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">RDD</div>
                        <div class="quiz-option" data-correct="true">DataFrame</div>
                        <div class="quiz-option" data-correct="false">Dataset</div>
                        <div class="quiz-option" data-correct="false">DataStream</div>
                    </div>
                    <div class="quiz-feedback">DataFrame - это основная абстракция в Spark SQL, представляющая распределенную коллекцию данных, организованных в именованные столбцы.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">22. Какой механизм гарантирует exactly-once семантику в Flink?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Lineage</div>
                        <div class="quiz-option" data-correct="true">Checkpointing</div>
                        <div class="quiz-option" data-correct="false">Replication</div>
                        <div class="quiz-option" data-correct="false">Sharding</div>
                    </div>
                    <div class="quiz-feedback">Механизм контрольных точек (checkpointing) в Flink обеспечивает exactly-once семантику, сохраняя состояние приложения и позиции в источниках данных.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">23. Какой язык программирования используется в Apache Pig?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">PigQL</div>
                        <div class="quiz-option" data-correct="true">Pig Latin</div>
                        <div class="quiz-option" data-correct="false">Pig Script</div>
                        <div class="quiz-option" data-correct="false">Pig Language</div>
                    </div>
                    <div class="quiz-feedback">Pig Latin - это язык сценариев высокого уровня, используемый в Apache Pig для анализа больших данных.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">24. Что такое "катализатор" (Catalyst) в Spark SQL?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">Оптимизатор запросов</div>
                        <div class="quiz-option" data-correct="false">Механизм кэширования</div>
                        <div class="quiz-option" data-correct="false">Система управления памятью</div>
                        <div class="quiz-option" data-correct="false">Протокол репликации</div>
                    </div>
                    <div class="quiz-feedback">Catalyst - это оптимизатор запросов в Spark SQL, который преобразует логические планы запросов в физические планы выполнения.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">25. Какой компонент Hadoop используется для сбора и агрегации логов?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Sqoop</div>
                        <div class="quiz-option" data-correct="false">ZooKeeper</div>
                        <div class="quiz-option" data-correct="true">Flume</div>
                        <div class="quiz-option" data-correct="false">Oozie</div>
                    </div>
                    <div class="quiz-feedback">Apache Flume предназначен для надежного сбора, агрегации и перемещения больших объемов лог-данных в HDFS.</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Инициализация Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });

        // Прогресс бар
        window.addEventListener('scroll', function() {
            const winHeight = window.innerHeight;
            const docHeight = document.documentElement.scrollHeight;
            const scrollTop = window.pageYOffset;
            const scrollPercent = scrollTop / (docHeight - winHeight);
            const progressBar = document.getElementById('progressBar');
            progressBar.style.transform = `scaleX(${scrollPercent})`;
        });

        // Плавная прокрутка для навигации
        document.querySelectorAll('.nav-item').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                targetElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });

                // Закрытие мобильного меню после клика
                const navigation = document.getElementById('navigation');
                navigation.classList.remove('active');
            });
        });

        // Динамическое обновление Mermaid при изменении размера окна
        window.addEventListener('resize', function() {
            mermaid.contentLoaded();
        });

        // Мобильное меню
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const navigation = document.getElementById('navigation');

        mobileMenuToggle.addEventListener('click', function() {
            navigation.classList.toggle('active');
        });

        // Тестовая логика
        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', function() {
                const isCorrect = this.getAttribute('data-correct') === 'true';
                const feedback = this.parentElement.nextElementSibling;

                // Сброс всех вариантов в этом вопросе
                this.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                    opt.classList.remove('correct', 'incorrect');
                });

                // Показ правильного/неправильного ответа
                if (isCorrect) {
                    this.classList.add('correct');
                    feedback.classList.add('correct');
                    feedback.classList.remove('incorrect');
                } else {
                    this.classList.add('incorrect');
                    feedback.classList.add('incorrect');
                    feedback.classList.remove('correct');

                    // Показать правильный ответ
                    const correctOption = this.parentElement.querySelector('.quiz-option[data-correct="true"]');
                    correctOption.classList.add('correct');
                }
            });
        });

        // Рендеринг формул KaTeX после загрузки DOM
        document.addEventListener('DOMContentLoaded', function() {
            // Формула 1
            katex.render("S = \\frac{1}{(1 - p) + \\frac{p}{N}}", document.getElementById('formula1'), {
                throwOnError: false
            });

            // Формула 2
            katex.render("\\text{CAP: Consistency, Availability, Partition Tolerance}", document.getElementById('formula2'), {
                throwOnError: false
            });

            // Формула 3
            katex.render("\\text{Block Size} = 128 \\text{ MB}", document.getElementById('formula3'), {
                throwOnError: false
            });

            // Формула 4
            katex.render("\\text{Replication Factor} = 3", document.getElementById('formula4'), {
                throwOnError: false
            });

            // Формула 5
            katex.render("\\text{MapReduce} = map(k1, v1) \\rightarrow list(k2, v2) \\\\ reduce(k2, list(v2)) \\rightarrow list(v3)", document.getElementById('formula5'), {
                throwOnError: false,
                displayMode: true
            });

            // Формула 6
            katex.render("\\frac{\\text{Spark Performance}}{\\text{MapReduce Performance}} = 10\\times - 100\\times", document.getElementById('formula6'), {
                throwOnError: false
            });

            // Исправление отображения строчных формул
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                    {left: '\\(', right: '\\)', display: false},
                    {left: '\\[', right: '\\]', display: true}
                ],
                throwOnError: false
            });
        });
    </script>
</body>
</html>