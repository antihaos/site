<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDN сети - Конспект лекции</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-card: #16213e;
            --accent-primary: #00d4ff;
            --accent-secondary: #ff2e63;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --border-color: #2d3748;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        }

        .lecture-title {
            font-size: 2.5em;
            color: var(--accent-primary);
            text-align: center;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }

        .lecture-subtitle {
            font-size: 1.2em;
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 30px;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        .section {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--border-color);
            position: relative;
            scroll-margin-top: 20px;
        }

        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
        }

        .section-title {
            font-size: 1.8em;
            color: var(--accent-primary);
            margin-bottom: 20px;
            border-bottom: 3px solid var(--accent-primary);
            padding-bottom: 10px;
            font-weight: 600;
        }

        .subsection {
            margin-bottom: 25px;
        }

        .subsection-title {
            font-size: 1.3em;
            color: var(--text-primary);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .text-content {
            margin-bottom: 20px;
            text-align: justify;
            color: var(--text-secondary);
        }

        .diagram {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--border-color);
            overflow-x: auto;
        }

        .code-block {
            background: #1e293b;
            color: var(--text-primary);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .code-block::before {
            content: 'Nginx Config';
            position: absolute;
            top: 0;
            right: 0;
            background: var(--accent-primary);
            color: var(--bg-primary);
            padding: 4px 10px;
            font-size: 0.8em;
            border-radius: 0 10px 0 10px;
            font-weight: bold;
        }

        .formula {
            background: #1e293b;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--accent-secondary);
            font-family: 'Cambria Math', serif;
        }

        .formula-title {
            font-size: 1.1em;
            color: var(--accent-primary);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .formula-explanation {
            margin-top: 10px;
            font-size: 0.9em;
            color: var(--text-secondary);
            text-align: left;
        }

        .katex-formula {
            font-size: 1.1em;
            overflow-x: auto;
            color: var(--text-primary);
            text-align: center;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--bg-secondary);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .comparison-table th {
            background: var(--accent-primary);
            color: var(--bg-primary);
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .comparison-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.05);
        }

        .comparison-table tr:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .highlight {
            background: linear-gradient(120deg, rgba(0, 212, 255, 0.2) 0%, rgba(255, 46, 99, 0.2) 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
            color: var(--accent-primary);
        }

        .navigation {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: rgba(26, 26, 46, 0.9);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            z-index: 100;
            max-height: 80vh;
            overflow-y: auto;
        }

        .nav-item {
            display: block;
            padding: 10px 15px;
            margin: 5px 0;
            background: var(--accent-primary);
            color: var(--bg-primary);
            text-decoration: none;
            border-radius: 5px;
            text-align: center;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover {
            background: var(--accent-secondary);
            transform: translateX(-5px);
        }

        ul, ol {
            margin-left: 20px;
            margin-bottom: 15px;
            color: var(--text-secondary);
        }

        li {
            margin-bottom: 8px;
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transform-origin: left;
            transform: scaleX(0);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .architecture-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .architecture-card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid var(--accent-primary);
            transition: transform 0.3s ease;
        }

        .architecture-card:hover {
            transform: translateY(-5px);
        }

        .architecture-title {
            font-size: 1.2em;
            color: var(--accent-primary);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .tech-card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid var(--accent-secondary);
            transition: transform 0.3s ease;
        }

        .tech-card:hover {
            transform: translateY(-5px);
        }

        .tech-name {
            font-size: 1.2em;
            color: var(--accent-secondary);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .mobile-menu-toggle {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--accent-primary);
            color: var(--bg-primary);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5em;
            cursor: pointer;
            z-index: 101;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .mobile-menu-toggle:hover {
            background: var(--accent-secondary);
            transform: scale(1.1);
        }

        .quiz-section {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-secondary);
        }

        .quiz-question {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .quiz-options {
            margin-bottom: 15px;
        }

        .quiz-option {
            display: block;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .quiz-option:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .quiz-option.correct {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
        }

        .quiz-option.incorrect {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.5);
        }

        .quiz-feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }

        .quiz-feedback.correct {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
            display: block;
        }

        .quiz-feedback.incorrect {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.5);
            display: block;
        }

        .key-points {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(255, 46, 99, 0.1) 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-primary);
        }

        .key-points-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--accent-primary);
        }

        .use-case-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .use-case-card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid var(--accent-primary);
        }

        .use-case-title {
            font-weight: 600;
            color: var(--accent-primary);
            margin-bottom: 10px;
        }

        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric-card {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--accent-primary);
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .navigation {
                display: none;
                width: 80%;
                right: 10%;
                top: 50%;
                transform: translateY(-50%);
            }

            .navigation.active {
                display: block;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .lecture-title {
                font-size: 2em;
            }

            .section {
                padding: 20px;
            }

            .section-title {
                font-size: 1.5em;
            }

            .header {
                padding: 25px;
            }

            .architecture-grid {
                grid-template-columns: 1fr;
            }

            .tech-grid {
                grid-template-columns: 1fr;
            }

            .use-case-grid {
                grid-template-columns: 1fr;
            }

            .performance-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .lecture-title {
                font-size: 1.7em;
            }

            .section {
                padding: 15px;
            }

            .header {
                padding: 20px;
            }

            .container {
                padding: 10px;
            }

            .performance-metrics {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="progress-bar" id="progressBar"></div>

    <button class="mobile-menu-toggle" id="mobileMenuToggle">☰</button>

    <div class="navigation" id="navigation">
        <a href="#section1" class="nav-item">Введение в CDN</a>
        <a href="#section2" class="nav-item">Архитектура CDN</a>
        <a href="#section3" class="nav-item">Технологии доставки</a>
        <a href="#section4" class="nav-item">Протоколы CDN</a>
        <a href="#section5" class="nav-item">Кэширование</a>
        <a href="#section6" class="nav-item">Безопасность</a>
        <a href="#section7" class="nav-item">Провайдеры CDN</a>
        <a href="#section8" class="nav-item">Производительность</a>
        <a href="#section9" class="nav-item">Реализация</a>
        <a href="#quiz" class="nav-item">Тест</a>
    </div>

    <div class="container">
        <div class="header">
            <h1 class="lecture-title">CDN (Content Delivery Network) сети</h1>
            <p class="lecture-subtitle">Технологии доставки контента и распределенные сети</p>
        </div>

        <div class="content">
            <!-- Раздел 1: Введение -->
            <div class="section" id="section1">
                <h2 class="section-title">1. Введение в CDN сети</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Что такое CDN и зачем она нужна?</h3>
                    <div class="text-content">
                        <p>CDN (Content Delivery Network) - это географически распределенная сеть серверов, которая обеспечивает быструю доставку веб-контента пользователям. Основная цель CDN - минимизировать задержку при доступе к веб-ресурсам.</p>
                    </div>

                    <div class="diagram">
                        <div class="mermaid">
                            graph LR
                                A[Пользователь в Европе] --> B[Европейский PoP]
                                C[Пользователь в Азии] --> D[Азиатский PoP]
                                E[Пользователь в Америке] --> F[Американский PoP]

                                B --> G[Origin Server]
                                D --> G
                                F --> G

                                style B fill:#4ecdc4
                                style D fill:#4ecdc4
                                style F fill:#4ecdc4
                                style G fill:#ff6b6b
                        </div>
                    </div>

                    <div class="text-content">
                        <p><strong>Проблемы, которые решает CDN:</strong></p>
                        <ul>
                            <li><span class="highlight">Высокая задержка (latency)</span>: физическое расстояние между пользователем и сервером</li>
                            <li><span class="highlight">Ограниченная пропускная способность</span>: узкие места в сетевой инфраструктуре</li>
                            <li><span class="highlight">Высокая нагрузка на origin-сервер</span>: множество одновременных запросов</li>
                            <li><span class="highlight">Низкая доступность</span>: единая точка отказа</li>
                        </ul>
                    </div>

                    <div class="performance-metrics">
                        <div class="metric-card">
                            <div class="metric-value">50-300%</div>
                            <div class="metric-label">Ускорение загрузки</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">30-70%</div>
                            <div class="metric-label">Снижение нагрузки</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">99.99%</div>
                            <div class="metric-label">Доступность</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">&lt; 50ms</div>
                            <div class="metric-label">Задержка TTFB</div>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">История развития CDN</h3>
                    <div class="diagram">
                        <div class="mermaid">
                            timeline
                                title История развития CDN
                                section 1990-е
                                    Проблема латентности : Рост интернета<br>выявил проблемы задержки
                                    Первые решения : Кэширующие прокси<br>и зеркалирование
                                section 1998-1999
                                    Akamai Technologies : Первая коммерческая CDN
                                    Sandpiper Networks : Конкурирующая платформа
                                section 2000-2005
                                    Расширение функционала : Поддержка streaming<br>и динамического контента
                                    Limelight Networks : Новый игрок<br>на рынке
                                section 2006-2010
                                    Cloud CDN : Интеграция с облачными<br>платформами
                                    Amazon CloudFront : CDN как сервис
                                section 2011-2015
                                    Mobile CDN : Оптимизация для<br>мобильных устройств
                                    Edge Computing : Вычисления на границе<br>сети
                                section 2016-2024
                                    Security Focus : Защита от DDoS<br>и бот-атак
                                    Serverless CDN : Бессерверные<br>архитектуры
                        </div>
                    </div>
                </div>

                <div class="key-points">
                    <div class="key-points-title">Ключевые моменты:</div>
                    <ul>
                        <li>CDN решает проблему географической задержки при доступе к контенту</li>
                        <li>Первые коммерческие CDN появились в конце 1990-х годов</li>
                        <li>Современные CDN обеспечивают ускорение загрузки на 50-300%</li>
                        <li>CDN снижают нагрузку на origin-сервер на 30-70%</li>
                    </ul>
                </div>
            </div>

            <!-- Раздел 2: Архитектура CDN -->
            <div class="section" id="section2">
                <h2 class="section-title">2. Архитектура CDN сетей</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Компоненты CDN архитектуры</h3>
                    <div class="diagram">
                        <div class="mermaid">
                            flowchart TD
                                A[Origin Server<br>Основной сервер] --> B[CDN Provider<br>Провайдер CDN]

                                B --> C[Edge Server 1<br>Пограничный сервер]
                                B --> D[Edge Server 2<br>Пограничный сервер]
                                B --> E[Edge Server N<br>Пограничный сервер]

                                F[User Europe] --> C
                                G[User Asia] --> D
                                H[User Americas] --> E

                                I[DNS System<br>Система DNS] --> F
                                I --> G
                                I --> H

                                C --> J[Cache Hit<br>Контент в кэше]
                                C --> K[Cache Miss<br>Запрос к origin]

                                style A fill:#ff6b6b
                                style C fill:#4ecdc4
                                style D fill:#4ecdc4
                                style E fill:#4ecdc4
                                style I fill:#ffe66d
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Ключевые компоненты</h3>

                    <div class="architecture-grid">
                        <div class="architecture-card">
                            <div class="architecture-title">Edge Servers (PoP)</div>
                            <div class="text-content">
                                <p>Пограничные серверы, расположенные в точках присутствия (Points of Presence) по всему миру.</p>
                                <ul>
                                    <li>Географически распределены</li>
                                    <li>Кэшируют статический контент</li>
                                    <li>Обрабатывают динамические запросы</li>
                                    <li>Обеспечивают балансировку нагрузки</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">Origin Server</div>
                            <div class="text-content">
                                <p>Основной сервер, где хранится оригинальный контент.</p>
                                <ul>
                                    <li>Источник истины для контента</li>
                                    <li>Обслуживает запросы от edge-серверов</li>
                                    <li>Хранит master-копии файлов</li>
                                    <li>Обычно расположен в дата-центре</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">DNS System</div>
                            <div class="text-content">
                                <p>Система доменных имен, которая направляет пользователей к ближайшему edge-серверу.</p>
                                <ul>
                                    <li>Географическая маршрутизация</li>
                                    <li>Load balancing</li>
                                    <li>Failover механизмы</li>
                                    <li>Anycast routing</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="formula">
                        <div class="formula-title">Формула эффективности CDN</div>
                        <div class="katex-formula" id="formula1"></div>
                        <div class="formula-explanation">
                            <p>где:</p>
                            <ul>
                                <li>\( T_{total} \) - общее время доставки контента</li>
                                <li>\( T_{latency} \) - сетевая задержка</li>
                                <li>\( T_{transfer} \) - время передачи данных</li>
                                <li>\( T_{processing} \) - время обработки на сервере</li>
                            </ul>
                            <p>CDN минимизирует все три компонента времени доставки.</p>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Типы CDN архитектур</h3>

                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Тип архитектуры</th>
                                <th>Описание</th>
                                <th>Преимущества</th>
                                <th>Недостатки</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Pull CDN</td>
                                <td>Контент загружается по запросу от edge-серверов</td>
                                <td>Простая настройка, автоматическое кэширование</td>
                                <td>Медленное первоначальное распространение</td>
                            </tr>
                            <tr>
                                <td>Push CDN</td>
                                <td>Контент заранее загружается на edge-серверы</td>
                                <td>Быстрый доступ, контроль над распространением</td>
                                <td>Сложнее в управлении, требует больше ресурсов</td>
                            </tr>
                            <tr>
                                <td>Peer-to-Peer CDN</td>
                                <td>Серверы обмениваются контентом между собой</td>
                                <td>Высокая масштабируемость, отказоустойчивость</td>
                                <td>Сложность реализации, проблемы с консистентностью</td>
                            </tr>
                            <tr>
                                <td>Hybrid CDN</td>
                                <td>Комбинация разных подходов</td>
                                <td>Гибкость, оптимизация под разные типы контента</td>
                                <td>Сложность управления и мониторинга</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Раздел 3: Технологии доставки -->
            <div class="section" id="section3">
                <h2 class="section-title">3. Технологии доставки контента</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Static Content Delivery</h3>

                    <div class="text-content">
                        <p>Доставка статического контента - основная функция CDN. Статический контент включает изображения, CSS, JavaScript, шрифты и другие файлы, которые не изменяются при каждом запросе.</p>
                    </div>

                    <div class="diagram">
                        <div class="mermaid">
                            sequenceDiagram
                                participant U as User
                                participant D as DNS
                                participant E as Edge Server
                                participant O as Origin Server

                                U->>D: DNS запрос example.com
                                D->>U: IP ближайшего edge-сервера

                                U->>E: HTTP запрос /image.jpg
                                alt Кэш существует
                                    E->>U: 200 OK (из кэша)
                                else Кэш отсутствует
                                    E->>O: Запрос к origin
                                    O->>E: 200 OK + контент
                                    E->>U: 200 OK + контент
                                    Note right of E: Кэширование контента
                                end
                        </div>
                    </div>

                    <div class="code-block"><pre>
# Пример конфигурации Nginx для статического контента
server {
    listen 80;
    server_name cdn.example.com;

    # Статические файлы
    location /static/ {
        root /var/www;
        expires 1y;
        add_header Cache-Control "public, immutable";
        add_header Access-Control-Allow-Origin "*";

        # Gzip сжатие
        gzip on;
        gzip_types text/css text/javascript application/javascript;
        gzip_comp_level 6;
    }

    # Изображения
    location ~* \.(jpg|jpeg|png|gif|webp)$ {
        root /var/www/images;
        expires 1M;
        add_header Cache-Control "public";

        # WebP автоматизация
        location ~* \.(jpg|jpeg|png)$ {
            add_header Vary Accept;
            set $webp "";
            if ($http_accept ~* "webp") {
                set $webp "webp";
            }
            try_files $uri$webp $uri =404;
        }
    }
}
                    </pre></div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Dynamic Content Acceleration</h3>

                    <div class="text-content">
                        <p>Ускорение динамического контента требует более сложных подходов, так как контент генерируется для каждого запроса индивидуально.</p>
                    </div>

                    <div class="architecture-grid">
                        <div class="architecture-card">
                            <div class="architecture-title">TCP Optimization</div>
                            <div class="text-content">
                                <p>Оптимизация TCP-соединений для уменьшения задержки.</p>
                                <ul>
                                    <li>TCP Fast Open</li>
                                    <li>Larger initial congestion window</li>
                                    <li>Better congestion control algorithms</li>
                                    <li>Persistent connections</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">Route Optimization</div>
                            <div class="text-content">
                                <p>Оптимизация маршрутов передачи данных.</p>
                                <ul>
                                    <li>Anycast routing</li>
                                    <li>BGP optimization</li>
                                    <li>Traffic engineering</li>
                                    <li>Peering agreements</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">Protocol Optimization</div>
                            <div class="text-content">
                                <p>Использование современных протоколов.</p>
                                <ul>
                                    <li>HTTP/2 и HTTP/3</li>
                                    <li>QUIC protocol</li>
                                    <li>TLS 1.3</li>
                                    <li>Brotli compression</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="formula">
                        <div class="formula-title">Время загрузки динамического контента</div>
                        <div class="katex-formula" id="formula2"></div>
                        <div class="formula-explanation">
                            <p>где \( RTT \) - время круговой задержки, \( n \) - количество запросов, \( T_{processing} \) - время обработки на сервере. CDN уменьшает RTT и оптимизирует количество запросов.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Раздел 4: Протоколы CDN -->
            <div class="section" id="section4">
                <h2 class="section-title">4. Протоколы и технологии CDN</h2>

                <div class="subsection">
                    <h3 class="subsection-title">HTTP/2 и HTTP/3 в CDN</h3>

                    <div class="text-content">
                        <p>Современные CDN активно используют HTTP/2 и HTTP/3 для улучшения производительности доставки контента.</p>
                    </div>

                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Протокол</th>
                                <th>Основные особенности</th>
                                <th>Преимущества для CDN</th>
                                <th>Поддержка</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>HTTP/1.1</td>
                                <td>Последовательные запросы, текстовые заголовки</td>
                                <td>Универсальная совместимость</td>
                                <td>100%</td>
                            </tr>
                            <tr>
                                <td>HTTP/2</td>
                                <td>Мультиплексирование, бинарные заголовки, server push</td>
                                <td>Уменьшение latency, лучшее использование соединения</td>
                                <td>95%+</td>
                            </tr>
                            <tr>
                                <td>HTTP/3 (QUIC)</td>
                                <td>UDP-based, встроенная безопасность, нулевое RTT</td>
                                <td>Устойчивость к потере пакетов, быстрее установка соединения</td>
                                <td>70%+</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="code-block"><pre>
# Конфигурация HTTP/2 в Nginx
server {
    listen 443 ssl http2;
    server_name cdn.example.com;

    ssl_certificate /path/to/certificate.crt;
    ssl_certificate_key /path/to/private.key;

    # HTTP/2 оптимизации
    http2_max_concurrent_streams 128;
    http2_max_field_size 16k;
    http2_max_header_size 32k;

    # Server Push для критических ресурсов
    location = /index.html {
        http2_push /style.css;
        http2_push /app.js;
    }

    # Brotli сжатие
    brotli on;
    brotli_types text/plain text/css application/javascript;
    brotli_comp_level 6;
}

# Конфигурация для HTTP/3 (QUIC)
server {
    listen 443 quic;
    listen 443 ssl;

    ssl_protocols TLSv1.3;
    quic_retry on;

    add_header Alt-Svc 'h3=":443"; ma=86400';
}
                    </pre></div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">DNS-маршрутизация в CDN</h3>

                    <div class="diagram">
                        <div class="mermaid">
                            sequenceDiagram
                                participant U as User
                                participant LD as Local DNS
                                participant AD as Authoritative DNS
                                participant GD as GSLB (Global Server Load Balancer)
                                participant E as Edge Server

                                U->>LD: Запрос www.example.com
                                LD->>AD: Рекурсивный запрос
                                AD->>GD: DNS запрос с IP пользователя

                                GD->>GD: Анализ местоположения<br>и загрузки серверов
                                GD->>AD: IP оптимального edge-сервера
                                AD->>LD: CNAME cdn.example.net
                                LD->>U: IP edge-сервера

                                U->>E: Прямое соединение
                        </div>
                    </div>

                    <div class="text-content">
                        <p><strong>Алгоритмы DNS-маршрутизации:</strong></p>
                        <ul>
                            <li><span class="highlight">GeoDNS</span>: на основе географического местоположения</li>
                            <li><span class="highlight">Latency-based</span>: минимальная задержка</li>
                            <li><span class="highlight">Weighted Round Robin</span>: взвешенное распределение</li>
                            <li><span class="highlight">Failover</span>: резервные серверы</li>
                            <li><span class="highlight">Anycast</span>: один IP для множества локаций</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Раздел 5: Кэширование -->
            <div class="section" id="section5">
                <h2 class="section-title">5. Стратегии кэширования в CDN</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Уровни кэширования</h3>

                    <div class="diagram">
                        <div class="mermaid">
                            graph TB
                                A[Browser Cache] --> B[Edge Cache L1]
                                B --> C[Edge Cache L2]
                                C --> D[Mid-tier Cache]
                                D --> E[Origin Shield]
                                E --> F[Origin Server]

                                style A fill:#4ecdc4
                                style B fill:#4ecdc4
                                style C fill:#4ecdc4
                                style D fill:#4ecdc4
                                style E fill:#4ecdc4
                                style F fill:#ff6b6b
                        </div>
                    </div>

                    <div class="architecture-grid">
                        <div class="architecture-card">
                            <div class="architecture-title">Browser Cache</div>
                            <div class="text-content">
                                <p>Кэш в браузере пользователя.</p>
                                <ul>
                                    <li>Время жизни: часы-дни</li>
                                    <li>Размер: ограничен браузером</li>
                                    <li>Управление: Cache-Control headers</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">Edge Cache</div>
                            <div class="text-content">
                                <p>Кэш на пограничных серверах CDN.</p>
                                <ul>
                                    <li>Время жизни: минуты-часы</li>
                                    <li>Размер: терабайты на PoP</li>
                                    <li>Управление: TTL, purge API</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">Origin Shield</div>
                            <div class="text-content">
                                <p>Защитный кэш перед origin-сервером.</p>
                                <ul>
                                    <li>Время жизни: дни-недели</li>
                                    <li>Размер: петабайты</li>
                                    <li>Управление: сложные правила</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">HTTP заголовки кэширования</h3>

                    <div class="code-block"><pre>
# Пример правильных HTTP заголовков для CDN

# Статический контент (долгое кэширование)
Cache-Control: public, max-age=31536000, immutable
ETag: "33a64df551425fcc55e4d42a148795d9f25f89d4"
Last-Modified: Wed, 21 Oct 2015 07:28:00 GMT

# Динамический контент (короткое кэширование)
Cache-Control: public, max-age=300, s-maxage=3600
Vary: Accept-Encoding, User-Agent
ETag: W/"a3f0-56781234"

# Контент, который никогда не должен кэшироваться
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Expires: 0

# Условные запросы для проверки свежести
If-None-Match: "33a64df551425fcc55e4d42a148795d9f25f89d4"
If-Modified-Since: Wed, 21 Oct 2015 07:28:00 GMT

# CDN-specific заголовки
Surrogate-Control: max-age=3600
CDN-Cache-Control: public, max-age=86400
                    </pre></div>

                    <div class="formula">
                        <div class="formula-title">Эффективность кэширования</div>
                        <div class="katex-formula" id="formula3"></div>
                        <div class="formula-explanation">
                            <p>где \( H \) - количество попаданий в кэш, \( M \) - количество промахов кэша. Высокий hit rate (>90%) указывает на эффективную стратегию кэширования.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Раздел 6: Безопасность -->
            <div class="section" id="section6">
                <h2 class="section-title">6. Безопасность в CDN сетях</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Защита от DDoS атак</h3>

                    <div class="text-content">
                        <p>CDN обеспечивают многоуровневую защиту от распределенных атак типа "отказ в обслуживании" (DDoS).</p>
                    </div>

                    <div class="architecture-grid">
                        <div class="architecture-card">
                            <div class="architecture-title">Network Layer Protection</div>
                            <div class="text-content">
                                <p>Защита на сетевом уровне.</p>
                                <ul>
                                    <li>Anycast распределение трафика</li>
                                    <li>Rate limiting</li>
                                    <li>IP reputation filtering</li>
                                    <li>BGP flow spec</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">Application Layer Protection</div>
                            <div class="text-content">
                                <p>Защита на уровне приложений.</p>
                                <ul>
                                    <li>Web Application Firewall (WAF)</li>
                                    <li>Bot detection</li>
                                    <li>Challenge-response (CAPTCHA)</li>
                                    <li>Behavioral analysis</li>
                                </ul>
                            </div>
                        </div>

                        <div class="architecture-card">
                            <div class="architecture-title">TLS/SSL Security</div>
                            <div class="text-content">
                                <p>Защита передаваемых данных.</p>
                                <ul>
                                    <li>TLS termination</li>
                                    <li>Certificate management</li>
                                    <li>Perfect Forward Secrecy</li>
                                    <li>HSTS enforcement</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="code-block"><pre>
# Конфигурация WAF в CDN
# Пример правил ModSecurity

# Защита от SQL injection
SecRule ARGS "@detectSQLi" \
    "id:1001,phase:2,deny,status:403,\
    msg:'SQL Injection Attack'"

# Защита от XSS
SecRule ARGS "@detectXSS" \
    "id:1002,phase:2,deny,status:403,\
    msg:'Cross-site Scripting Attack'"

# Rate limiting
SecRule REQUEST_URI "@streq /api/" \
    "id:1003,phase:1,pass,\
    setvar:TX.rate=+1,\
    expirevar:TX.rate=60"

SecRule TX:rate "@gt 100" \
    "id:1004,phase:1,deny,status:429,\
    msg:'Rate limit exceeded'"

# Bot protection
SecRule REQUEST_HEADERS:User-Agent \
    "@pm googlebot bingbot" \
    "id:1005,phase:1,pass,\
    setvar:TX.trusted_bot=1"

SecRule TX:trusted_bot "!@eq 1" \
    "id:1006,phase:1,deny,status:403,\
    msg:'Suspicious bot detected'"
                    </pre></div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">TLS/SSL оптимизации</h3>

                    <div class="text-content">
                        <p>Современные CDN используют различные техники для оптимизации TLS/SSL соединений.</p>
                    </div>

                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Технология</th>
                                <th>Описание</th>
                                <th>Эффект</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Session Resumption</td>
                                <td>Повторное использование TLS сессий</td>
                                <td>Уменьшение RTT на 1 цикл</td>
                            </tr>
                            <tr>
                                <td>OCSP Stapling</td>
                                <td>Включение статуса сертификата в handshake</td>
                                <td>Устранение отдельного OCSP запроса</td>
                            </tr>
                            <tr>
                                <td>False Start</td>
                                <td>Начало передачи данных до завершения handshake</td>
                                <td>Уменьшение latency на 30%</td>
                            </tr>
                            <tr>
                                <td>TLS 1.3</td>
                                <td>Современная версия протокола</td>
                                <td>1-RTT handshake, улучшенная безопасность</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Раздел 7: Провайдеры CDN -->
            <div class="section" id="section7">
                <h2 class="section-title">7. Основные провайдеры CDN</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Сравнение платформ</h3>

                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Провайдер</th>
                                <th>Основан</th>
                                <th>PoP локаций</th>
                                <th>Ключевые особенности</th>
                                <th>Ценовая модель</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Akamai</td>
                                <td>1998</td>
                                <td>4,200+</td>
                                <td>Enterprise-grade, высокая безопасность</td>
                                <td>Контрактная</td>
                            </tr>
                            <tr>
                                <td>Cloudflare</td>
                                <td>2009</td>
                                <td>1,200+</td>
                                <td>Удобство использования, бесплатный тариф</td>
                                <td>Pay-as-you-go</td>
                            </tr>
                            <tr>
                                <td>Amazon CloudFront</td>
                                <td>2008</td>
                                <td>450+</td>
                                <td>Интеграция с AWS, хорошая производительность</td>
                                <td>Исходящий трафик</td>
                            </tr>
                            <tr>
                                <td>Fastly</td>
                                <td>2011</td>
                                <td>100+</td>
                                <td>Real-time purging, edge computing</td>
                                <td>Премиум</td>
                            </tr>
                            <tr>
                                <td>Google Cloud CDN</td>
                                <td>2016</td>
                                <td>130+</td>
                                <td>Интеграция с Google Cloud, низкая latency</td>
                                <td>Исходящий трафик</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Выбор CDN провайдера</h3>

                    <div class="use-case-grid">
                        <div class="use-case-card">
                            <div class="use-case-title">Enterprise</div>
                            <div class="text-content">
                                <p><strong>Рекомендуется:</strong> Akamai, Cloudflare Enterprise</p>
                                <ul>
                                    <li>Высокие требования к безопасности</li>
                                    <li>Глобальное покрытие</li>
                                    <li>SLAs с гарантиями</li>
                                    <li>Поддержка 24/7</li>
                                </ul>
                            </div>
                        </div>

                        <div class="use-case-card">
                            <div class="use-case-title">SMB/SaaS</div>
                            <div class="text-content">
                                <p><strong>Рекомендуется:</strong> Cloudflare, Fastly</p>
                                <ul>
                                    <li>Гибкая ценовая модель</li>
                                    <li>Простота настройки</li>
                                    <li>Хорошая документация</li>
                                    <li>API для автоматизации</li>
                                </ul>
                            </div>
                        </div>

                        <div class="use-case-card">
                            <div class="use-case-title">Cloud-Native</div>
                            <div class="text-content">
                                <p><strong>Рекомендуется:</strong> AWS CloudFront, Google Cloud CDN</p>
                                <ul>
                                    <li>Интеграция с облачной платформой</li>
                                    <li>Единый биллинг</li>
                                    <li>Совместное использование сервисов</li>
                                    <li>Автоматическое масштабирование</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="formula">
                        <div class="formula-title">Формула стоимости CDN</div>
                        <div class="katex-formula" id="formula4"></div>
                        <div class="formula-explanation">
                            <p>где \( V \) - объем трафика, \( R \) - регион доставки, \( F \) - дополнительные функции (безопасность, аналитика). Стоимость зависит от множества факторов и может значительно варьироваться между провайдерами.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Раздел 8: Производительность -->
            <div class="section" id="section8">
                <h2 class="section-title">8. Мониторинг и оптимизация производительности</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Ключевые метрики CDN</h3>

                    <div class="performance-metrics">
                        <div class="metric-card">
                            <div class="metric-value">TTFB</div>
                            <div class="metric-label">Time to First Byte<br>Цель: &lt; 100ms</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">Hit Ratio</div>
                            <div class="metric-label">Эффективность кэша<br>Цель: > 90%</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">RTT</div>
                            <div class="metric-label">Round Trip Time<br>Цель: &lt; 50ms</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">Uptime</div>
                            <div class="metric-label">Доступность<br>Цель: 99.99%</div>
                        </div>
                    </div>

                    <div class="text-content">
                        <p><strong>Дополнительные метрики для мониторинга:</strong></p>
                        <ul>
                            <li><span class="highlight">Cache Hit/Miss Ratio</span>: эффективность кэширования</li>
                            <li><span class="highlight">Bandwidth Usage</span>: потребление пропускной способности</li>
                            <li><span class="highlight">Error Rate</span>: процент ошибочных ответов</li>
                            <li><span class="highlight">Origin Offload</span>: сколько трафика не доходит до origin</li>
                            <li><span class="highlight">Geographic Distribution</span>: распределение трафика по регионам</li>
                        </ul>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Инструменты мониторинга</h3>

                    <div class="tech-grid">
                        <div class="tech-card">
                            <div class="tech-name">Real User Monitoring (RUM)</div>
                            <div class="text-content">
                                <p>Сбор метрик от реальных пользователей.</p>
                                <ul>
                                    <li>Google Analytics</li>
                                    <li>New Relic Browser</li>
                                    <li>Datadog RUM</li>
                                    <li>Akamai mPulse</li>
                                </ul>
                            </div>
                        </div>

                        <div class="tech-card">
                            <div class="tech-name">Synthetic Monitoring</div>
                            <div class="text-content">
                                <p>Имитация пользовательских запросов.</p>
                                <ul>
                                    <li>WebPageTest</li>
                                    <li>Pingdom</li>
                                    <li>GTmetrix</li>
                                    <li>Lighthouse CI</li>
                                </ul>
                            </div>
                        </div>

                        <div class="tech-card">
                            <div class="tech-name">CDN Analytics</div>
                            <div class="text-content">
                                <p>Встроенные аналитические панели.</p>
                                <ul>
                                    <li>Cloudflare Analytics</li>
                                    <li>AWS CloudFront Reports</li>
                                    <li>Akamai Ion</li>
                                    <li>Fastly Real-time Analytics</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Раздел 9: Реализация -->
            <div class="section" id="section9">
                <h2 class="section-title">9. Практическая реализация CDN</h2>

                <div class="subsection">
                    <h3 class="subsection-title">Интеграция CDN с веб-приложением</h3>

                    <div class="code-block"><pre>
<!-- Пример интеграции CDN в HTML -->
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Пример с CDN</title>

    <!-- Подключение CSS через CDN -->
    <link rel="stylesheet" href="https://cdn.example.com/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.example.com/css/app.css">

    <!-- Preload критических ресурсов -->
    <link rel="preload" href="https://cdn.example.com/fonts/roboto.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://cdn.example.com/js/chunk-123.js" as="script">

    <!-- Preconnect к CDN доменам -->
    <link rel="preconnect" href="https://cdn.example.com">
    <link rel="dns-prefetch" href="https://cdn.example.com">
</head>
<body>
    <!-- Контент страницы -->

    <!-- Подключение JavaScript через CDN -->
    <script src="https://cdn.example.com/js/react.production.min.js"></script>
    <script src="https://cdn.example.com/js/react-dom.production.min.js"></script>
    <script src="https://cdn.example.com/js/app.js"></script>

    <!-- Lazy loading изображений -->
    <img data-src="https://cdn.example.com/images/hero.jpg"
         src="https://cdn.example.com/images/placeholder.jpg"
         class="lazyload"
         alt="Hero Image">

    <script>
        // Инициализация lazy loading
        if ('IntersectionObserver' in window) {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.classList.remove('lazyload');
                        observer.unobserve(img);
                    }
                });
            });

            document.querySelectorAll('.lazyload').forEach(img => {
                observer.observe(img);
            });
        }
    </script>
</body>
</html>
                    </pre></div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">Конфигурация для различных типов контента</h3>

                    <div class="code-block"><pre>
# Пример конфигурации CloudFront Distribution
{
    "DistributionConfig": {
        "Origins": {
            "Quantity": 1,
            "Items": [
                {
                    "Id": "S3-origin",
                    "DomainName": "bucket.s3.amazonaws.com",
                    "OriginPath": "/static",
                    "CustomHeaders": {
                        "Quantity": 0
                    }
                }
            ]
        },
        "DefaultCacheBehavior": {
            "TargetOriginId": "S3-origin",
            "ViewerProtocolPolicy": "redirect-to-https",
            "AllowedMethods": {
                "Quantity": 2,
                "Items": ["GET", "HEAD"],
                "CachedMethods": {
                    "Quantity": 2,
                    "Items": ["GET", "HEAD"]
                }
            },
            "ForwardedValues": {
                "QueryString": false,
                "Cookies": {"Forward": "none"},
                "Headers": {"Quantity": 0}
            },
            "MinTTL": 0,
            "DefaultTTL": 86400,
            "MaxTTL": 31536000,
            "Compress": true
        },
        "CacheBehaviors": {
            "Quantity": 2,
            "Items": [
                {
                    "PathPattern": "*.jpg",
                    "TargetOriginId": "S3-origin",
                    "ForwardedValues": {"QueryString": false},
                    "MinTTL": 0,
                    "DefaultTTL": 2592000, // 30 дней
                    "MaxTTL": 31536000    // 1 год
                },
                {
                    "PathPattern": "/api/*",
                    "TargetOriginId": "S3-origin",
                    "ForwardedValues": {"QueryString": true},
                    "MinTTL": 0,
                    "DefaultTTL": 0,      // Не кэшировать
                    "MaxTTL": 0
                }
            ]
        },
        "PriceClass": "PriceClass_All",
        "Enabled": true
    }
}
                    </pre></div>
                </div>
            </div>

            <!-- Раздел: Тест -->
            <div class="section" id="quiz">
                <h2 class="section-title">Тест: Проверка знаний по CDN</h2>

                <div class="quiz-section">
                    <div class="quiz-question">1. Какой основной механизм использует CDN для уменьшения задержки доставки контента?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Увеличение пропускной способности каналов</div>
                        <div class="quiz-option" data-correct="true">Географическое распределение серверов</div>
                        <div class="quiz-option" data-correct="false">Использование более быстрых процессоров</div>
                        <div class="quiz-option" data-correct="false">Сжатие всех передаваемых данных</div>
                    </div>
                    <div class="quiz-feedback">Правильно! Основной механизм CDN - географическое распределение серверов (Points of Presence), что позволяет доставлять контент из локации, ближайшей к пользователю.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">2. Какой HTTP заголовок наиболее эффективен для долгосрочного кэширования статических ресурсов?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">Cache-Control: no-cache</div>
                        <div class="quiz-option" data-correct="false">Pragma: no-cache</div>
                        <div class="quiz-option" data-correct="true">Cache-Control: public, max-age=31536000</div>
                        <div class="quiz-option" data-correct="false">Expires: -1</div>
                    </div>
                    <div class="quiz-feedback">Верно! Cache-Control: public, max-age=31536000 указывает браузерам и CDN кэшировать ресурс на 1 год (31536000 секунд) и что ресурс может кэшироваться публично.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">3. Какой тип DNS-маршрутизации использует один IP-адрес для множества географических локаций?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">Anycast</div>
                        <div class="quiz-option" data-correct="false">Unicast</div>
                        <div class="quiz-option" data-correct="false">Multicast</div>
                        <div class="quiz-option" data-correct="false">Broadcast</div>
                    </div>
                    <div class="quiz-feedback">Правильно! Anycast маршрутизация позволяет множеству серверов в разных локациях отвечать на один IP-адрес, а BGP направляет трафик к ближайшему серверу.</div>
                </div>

                <div class="quiz-section">
                    <div class="quiz-question">4. Какой протокол использует HTTP/3 для транспорта вместо TCP?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="false">WebSocket</div>
                        <div class="quiz-option" data-correct="false">WebRTC</div>
                        <div class="quiz-option" data-correct="true">QUIC</div>
                        <div class="quiz-option" data-correct="false">SPDY</div>
                    </div>
                    <div class="quiz-feedback">Верно! HTTP/3 использует QUIC (Quick UDP Internet Connections) протокол, который работает поверх UDP и обеспечивает лучшую производительность, особенно при потере пакетов.</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Инициализация Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });

        // Прогресс бар
        window.addEventListener('scroll', function() {
            const winHeight = window.innerHeight;
            const docHeight = document.documentElement.scrollHeight;
            const scrollTop = window.pageYOffset;
            const scrollPercent = scrollTop / (docHeight - winHeight);
            const progressBar = document.getElementById('progressBar');
            progressBar.style.transform = `scaleX(${scrollPercent})`;
        });

        // Плавная прокрутка для навигации
        document.querySelectorAll('.nav-item').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                targetElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });

                // Закрытие мобильного меню после клика
                const navigation = document.getElementById('navigation');
                navigation.classList.remove('active');
            });
        });

        // Динамическое обновление Mermaid при изменении размера окна
        window.addEventListener('resize', function() {
            mermaid.contentLoaded();
        });

        // Мобильное меню
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const navigation = document.getElementById('navigation');

        mobileMenuToggle.addEventListener('click', function() {
            navigation.classList.toggle('active');
        });

        // Тестовая логика
        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', function() {
                const isCorrect = this.getAttribute('data-correct') === 'true';
                const feedback = this.parentElement.nextElementSibling;

                // Сброс всех вариантов в этом вопросе
                this.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                    opt.classList.remove('correct', 'incorrect');
                });

                // Показ правильного/неправильного ответа
                if (isCorrect) {
                    this.classList.add('correct');
                    feedback.classList.add('correct');
                    feedback.classList.remove('incorrect');
                } else {
                    this.classList.add('incorrect');
                    feedback.classList.add('incorrect');
                    feedback.classList.remove('correct');

                    // Показать правильный ответ
                    const correctOption = this.parentElement.querySelector('.quiz-option[data-correct="true"]');
                    correctOption.classList.add('correct');
                }
            });
        });

        // Рендеринг формул KaTeX после загрузки DOM
        document.addEventListener('DOMContentLoaded', function() {
            // Формула 1
            katex.render("T_{total} = T_{latency} + T_{transfer} + T_{processing}", document.getElementById('formula1'), {
                throwOnError: false
            });

            // Формула 2
            katex.render("T_{dynamic} = RTT \\times n + T_{processing}", document.getElementById('formula2'), {
                throwOnError: false
            });

            // Формула 3
            katex.render("Hit\\,Rate = \\frac{H}{H + M} \\times 100\\%", document.getElementById('formula3'), {
                throwOnError: false
            });

            // Формула 4
            katex.render("Cost = f(V, R, F)", document.getElementById('formula4'), {
                throwOnError: false
            });

            // Исправление отображения строчных формул
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                    {left: '\\(', right: '\\)', display: false},
                    {left: '\\[', right: '\\]', display: true}
                ],
                throwOnError: false
            });
        });
    </script>
</body>
</html>